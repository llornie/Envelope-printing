<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Print Envelope</title>
  <style>
    @page { size: 9.5in 4.125in; margin: 0; }
    html, body {
      width: 9.5in;
      height: 4.125in;
      margin: 0;
      padding: 0;
      background: #fff;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
      font-family: system-ui, -apple-system, "Segoe UI",
                   Roboto, Helvetica, Arial, sans-serif;
    }

    .envelope {
      position: relative;
      width: 9.5in;
      height: 4.125in;
      overflow: hidden;
    }

    #logo {
      position: absolute;
      top: 0.10in;
      left: 0.35in;
      height: 2.4in;
      width: auto;
    }

    #addr {
      position: absolute;
      top: 1.80in;
      left: 3.00in;
      width: 4.25in;
      font-size: 14pt;
      line-height: 1.4;
      white-space: pre-wrap;
    }

    .debug #logo { outline: 1px dashed #c33; }
    .debug #addr { outline: 1px dashed #36c; }
  </style>
</head>

<body>
  <div id="root" class="envelope">
    <img id="logo" src="logo_imf.png?v=3" alt="Return Address Logo" />
    <div id="addr"></div>
  </div>

  <script>
    const qs = new URLSearchParams(window.location.search);
    const get = (k, d="") => qs.get(k) ?? d;
    const getNum = (k, d) => {
      const v = qs.get(k);
      if (v == null) return d;
      const n = Number(v);
      return Number.isFinite(n) ? n : d;
    };
    const inches = n => `${n}in`;

    const logoH   = getNum("logoH", 2.4);
    const logoTop = getNum("logoTop", 0.10);
    const logoLeft= getNum("logoLeft",0.35);

    const addrTop = getNum("addrTop", 1.80);
    const addrLeft= getNum("addrLeft",3.00);

    const fontPt  = getNum("fontPt", 14);
    const lineHt  = getNum("lineHt",1.4);

    const debug   = get("debug","") === "1";
    const autoprint = get("autoprint","1") === "1";

    const root = document.getElementById("root");
    if (debug) root.classList.add("debug");

    const logo = document.getElementById("logo");
    logo.style.height =
